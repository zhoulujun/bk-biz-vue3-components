{"version":3,"file":"IFrame.stories-2910fc53.js","sources":["../../src/components/loading/index.tsx","../../src/components/iframe/index.tsx"],"sourcesContent":["import { defineComponent, PropType } from 'vue';\nimport { Loading } from 'bkui-vue';\n\nexport default defineComponent({\n  name: 'LoadingPlaceholder',\n  props: {\n    title: {\n      type: String,\n      default: '',\n    },\n    size: {\n      type: String as PropType<'small' | 'large' | 'mini'>,\n      default: 'small',\n    },\n  },\n  render() {\n    return (\n      <div class=\"full-width full-height flex-row align-items-center justify-content-center text-center\">\n        <Loading size={this.size} title={this.title}/>\n      </div>\n    );\n  },\n});\n","import { computed, CSSProperties, defineComponent, onMounted, ref } from 'vue';\nimport Loading from '../loading';\nimport './index.scss';\nimport { Message } from 'bkui-vue';\n\nexport default defineComponent({\n  name: 'IFrame',\n  props: {\n    link: String,\n    loading: {\n      type: Boolean,\n      default: false,\n    },\n    placeholder: String,\n    contentWidth: {\n      type: String || Number,\n      default: '100%',\n    },\n  },\n  emits: ['load', 'error'],\n  setup(props, { emit }) {\n    const rightRef = ref<HTMLElement>(null);\n    const loading = ref(true);\n    onMounted(() => {\n      loading.value = false;\n    });\n    const loadingFrame = computed(() => props.loading || loading.value);\n\n    let width  = 1920;\n    const frameStyle = computed<CSSProperties>(() => {\n      if (loadingFrame.value || !props.link) {\n        return null;\n      }\n      if (typeof props.contentWidth === 'string') {\n        if (!/\\d+/.test(props.contentWidth)) {\n          return {\n            width: props.contentWidth,\n          };\n        }\n        width = parseInt(props.contentWidth, 10);\n      } else {\n        width = props.contentWidth || 1920;\n      }\n      let zoom = 0;\n      let height = '100%';\n      console.log('rightRef.value?.clientWidth', rightRef.value?.clientWidth);\n      if (rightRef.value?.clientWidth) {\n        const { clientWidth, clientHeight } = rightRef.value;\n        zoom = clientWidth / width;\n        height = `${(clientHeight / zoom).toFixed(0)}px`;\n      }\n      return {\n        width: `${width}px`,\n        height,\n        transform: `scale3d(${zoom},${zoom},1)`,\n        'transform-origin': '0 0',\n      };\n    });\n\n    function onLoad(e: Event) {\n      // Message({ theme: 'success', message: '预览页加载成功' });\n      emit('load', e);\n    }\n\n    function onError(e: Event) {\n      Message({ theme: 'error', message: '预览页加载失败' });\n      emit('error', e);\n    }\n\n    return {\n      loadingFrame,\n      frameStyle,\n      rightRef,\n      onLoad,\n      onError,\n    };\n  },\n  render() {\n    return (\n      <div class=\"iframe-box\" ref=\"rightRef\">\n        {!this.link && this.placeholder ? (\n          <div class=\"full-height flex-column justify-content-center align-items-center\">\n            {this.placeholder}\n          </div>\n        ) : ''}\n        {\n          this.loading || !this.frameStyle ? (<Loading/>) : (\n            <iframe\n              onLoad={this.onLoad}\n              onError={this.onError}\n              style={this.frameStyle}\n              src={this.link} frameborder=\"0\"/>\n          )\n        }\n      </div>\n    );\n  },\n\n});\n"],"names":["defineComponent","name","props","title","type","String","default","size","render","_createVNode","Loading","link","loading","Boolean","placeholder","contentWidth","Number","emits","setup","emit","rightRef","ref","onMounted","value","loadingFrame","computed","width","frameStyle","test","parseInt","zoom","height","console","log","clientWidth","clientHeight","toFixed","transform","onLoad","e","onError","Message","theme","message"],"mappings":"4HAGA,MAAeA,IAAgB,CAC7BC,KAAM,qBACNC,MAAO,CACLC,MAAO,CACLC,KAAMC,OACNC,QAAS,EACV,EACDC,KAAM,CACJH,KAAMC,OACNC,QAAS,OACX,CACD,EACDE,QAAS,CACP,OAAAC,EAAA,MAAA,CAAA,MACa,yFAAuFA,CAAAA,EAAAC,EAAA,CAAA,KACjF,KAAKH,KAAI,MAAS,KAAKJ,KAAK,EAAA,IAAA,CAAA,CAAA,CAGjD,CACF,CAAC,ECjBD,MAAeH,IAAgB,CAC7BC,KAAM,SACNC,MAAO,CACLS,KAAMN,OACNO,QAAS,CACPR,KAAMS,QACNP,QAAS,EACV,EACDQ,YAAaT,OACbU,aAAc,CACZX,KAAMC,QAAUW,OAChBV,QAAS,MACX,CACD,EACDW,MAAO,CAAC,OAAQ,OAAO,EACvBC,MAAMhB,EAAO,CAAEiB,KAAAA,CAAK,EAAG,CACrB,MAAMC,EAAWC,EAAiB,IAAI,EAChCT,EAAUS,EAAI,EAAI,EACxBC,EAAU,IAAM,CACdV,EAAQW,MAAQ,EAClB,CAAC,EACD,MAAMC,EAAeC,EAAS,IAAMvB,EAAMU,SAAWA,EAAQW,KAAK,EAElE,IAAIG,EAAS,KACb,MAAMC,EAAaF,EAAwB,IAAM,SAC/C,GAAID,EAAaD,OAAS,CAACrB,EAAMS,KAC/B,OAAO,KAET,GAAI,OAAOT,EAAMa,cAAiB,SAAU,CAC1C,GAAI,CAAC,MAAMa,KAAK1B,EAAMa,YAAY,EAChC,MAAO,CACLW,MAAOxB,EAAMa,cAGjBW,EAAQG,SAAS3B,EAAMa,aAAc,EAAE,OAEvCW,EAAQxB,EAAMa,cAAgB,KAEhC,IAAIe,EAAO,EACPC,EAAS,OAEb,GADAC,QAAQC,IAAI,+BAA+Bb,EAAAA,EAASG,QAATH,YAAAA,EAAgBc,WAAW,GAClEd,EAAAA,EAASG,QAATH,MAAAA,EAAgBc,YAAa,CAC/B,KAAM,CAAEA,YAAAA,EAAaC,aAAAA,GAAiBf,EAASG,MAC/CO,EAAOI,EAAcR,EACrBK,EAAU,IAAGI,EAAeL,GAAMM,QAAQ,CAAC,MAE7C,MAAO,CACLV,MAAQ,GAAEA,MACVK,OAAAA,EACAM,UAAY,WAAUP,KAAQA,OAC9B,mBAAoB,MAExB,CAAC,EAED,SAASQ,EAAOC,EAAU,CAExBpB,EAAK,OAAQoB,CAAC,CAChB,CAEA,SAASC,EAAQD,EAAU,CACzBE,EAAQ,CAAEC,MAAO,QAASC,QAAS,SAAU,CAAC,EAC9CxB,EAAK,QAASoB,CAAC,CACjB,CAEA,MAAO,CACLf,aAAAA,EACAG,WAAAA,EACAP,SAAAA,EACAkB,OAAAA,EACAE,QAAAA,EAEH,EACDhC,QAAS,CACP,OAAAC,EAAA,MAAA,CAAA,MACa,aAAY,IAAK,YACzB,CAAA,CAAC,KAAKE,MAAQ,KAAKG,YAAWL,EAAA,MAAA,CAAA,MAClB,mEAAmE,EAAA,CAC3E,KAAKK,WAAW,GAEjB,GAEF,KAAKF,SAAW,CAAC,KAAKe,WAAUlB,EAAAC,aAAAD,EAAA,SAAA,CAAA,OAEpB,KAAK6B,OAAM,QACV,KAAKE,QAAO,MACd,KAAKb,WAAU,IACjB,KAAKhB,KAAI,YAAc,KAC/B,IAAA,CAAA,CAAA,CAIT,CAEF,CAAC;;;;;;;;;;;;;;;;"}