{"version":3,"file":"StickyBottom.stories-db5d5b73.js","sources":["../../src/components/sticky-bottom/index.tsx","../../src/stories/StickyBottom.stories.mdx"],"sourcesContent":["import { computed, defineComponent, onBeforeUnmount, onMounted, PropType, ref, StyleValue, Teleport, } from 'vue';\nimport './index.scss';\n\nexport default defineComponent({\n  name: 'StickyBottom',\n  props: {\n    offsetTarget: {\n      type: Function as PropType<() => Element>,\n      default: (): Element => null,\n    },\n    isFixed: Boolean,\n    paddingLeft: {\n      type: Number,\n      default: 60,\n    },\n    to: {\n      type: String,\n      default: 'body',\n    },\n  },\n  setup(props) {\n    const placeholderRef = ref<HTMLElement>(null);\n    const isShowPlaceholder = ref(true);\n    const dynamicStyles = computed<StyleValue>(() => {\n      return {\n        position: props.isFixed ? 'fixed' : 'absolute',\n        paddingLeft: `${props.paddingLeft}px`,\n      };\n    });\n    onMounted(() => {\n      let observeIo = new IntersectionObserver(\n        (entries) => {\n          console.log(entries[0].intersectionRatio);\n          if (entries[0].intersectionRatio > 0) {\n            isShowPlaceholder.value = true;\n          } else {\n            isShowPlaceholder.value = false;\n          }\n        },\n        {\n          threshold: [0.1],\n        },\n      );\n      let timer = setTimeout(() => {\n        placeholderRef.value && observeIo.observe(placeholderRef.value);\n        clearTimeout(timer);\n        timer = null;\n      }, 200);\n      onBeforeUnmount(() => {\n        observeIo.disconnect();\n        observeIo = null;\n      });\n    });\n\n    return {\n      placeholderRef,\n      isShowPlaceholder,\n      dynamicStyles,\n    };\n  },\n  render() {\n    return (\n      <>\n        <div ref=\"placeholderRef\">\n          {this.$slots?.default()}\n        </div>\n        {!this.isShowPlaceholder ? (\n          <Teleport disabled={!this.isFixed} to={this.to}>\n            <div\n              ref=\"actionRef\"\n              class=\"smart-action-box\"\n              style={this.dynamicStyles}>\n              {this.$slots?.default()}\n            </div>\n          </Teleport>\n        ) : ''}\n\n      </>\n    );\n  },\n\n});\n","import { Button } from 'bkui-vue';\n\n\nimport { Canvas, Meta, Story } from '@storybook/addon-docs';\n\nimport StickyBottom from '../components/sticky-bottom/index';\n\n<Meta\n  title=\"Example/StickyBottom\"\n  argTypes={{\n    isFixed: {\n      type: { name: 'boolean', required: false },\n      defaultValue: false,\n      control: 'boolean',\n    },\n    paddingLeft: {\n      type: { name: 'number', required: false },\n      defaultValue: 60,\n      control: 'number',\n    },\n    to: {\n      description: '插入元素',\n      defaultValue: 'body',\n      control: 'text',\n    },\n  }}\n  component={StickyBottom}\n/>\n\nexport const Template = (args) => ({\n  components: { StickyBottom, Button },\n  setup() {\n    return { args };\n  },\n  template: '<div style=\"height: 300px;position: relative;overflow: auto;border: 1px solid #ccc;\"><div ' +\n    'style=\"height: 100%;overflow: auto;\">父容器高度600<div ' +\n    'style=\"height:1500px;' +\n    '\">高度1500填充</div><StickyBottom ' +\n    'v-bind=\"args\" ' +\n    '><Button  ' +\n    'class=\"mr-min\" ' +\n    'theme=\"primary\">下一步</Button></StickyBottom></div><div>',\n});\n\n# StickyBottom\n\n吸底，表单提交按钮，自动吸底。\n\n<Story\n  name=\"Primary\"\n  args={{\n    paddingLeft: 120,\n  }}>\n  {Template.bind({})}\n</Story>\n"],"names":["defineComponent","name","props","offsetTarget","type","Function","default","isFixed","Boolean","paddingLeft","Number","to","String","setup","placeholderRef","ref","isShowPlaceholder","dynamicStyles","computed","position","onMounted","observeIo","IntersectionObserver","entries","console","log","intersectionRatio","value","threshold","timer","setTimeout","observe","clearTimeout","onBeforeUnmount","disconnect","render","_createVNode","_Fragment","_a","$slots","Teleport","Template","args","StickyBottom","Button","_createMdxContent","_components","_provideComponents","_jsxs","_jsx","Meta","Story","MDXContent","MDXLayout","primary","componentMeta","__namedExportsOrder"],"mappings":"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"}